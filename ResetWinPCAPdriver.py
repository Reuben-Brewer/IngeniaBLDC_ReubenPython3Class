# -*- coding: utf-8 -*-

'''
Reuben Brewer, Ph.D.
reuben.brewer@gmail.com
www.reubotics.com

Apache 2 License
Software Revision N, 12/26/2025

Verified working on: Python 3.11/12/13 for Windows 10, 11 64-bit.
'''

__author__ = 'reuben.brewer'

#########################################################
import os
import sys
import subprocess
import time
import traceback
import platform

from elevate import elevate #https://pypi.org/project/elevate/
#########################################################

##########################################################################################################
##########################################################################################################
##########################################################################################################
def ResetWinPCAPdriver():

    try:

        ##########################################################################################################
        ##########################################################################################################
        if platform.system() == "Windows":

            elevate(show_console=True)

            print("@@@@@@@@@@@@@@@@@@@ Trying to ResetWinPCAPdriver @@@@@@@@@@@@@@@@@@@")

            subprocess.run("sc stop npf", shell=True)
            subprocess.run("sc start npf", shell=True)

            print("@@@@@@@@@@@@@@@@@@@ Success for ResetWinPCAPdriver @@@@@@@@@@@@@@@@@@@")

            time.sleep(2.0)

            return 1

        else:
            return 0

        ##########################################################################################################
        ##########################################################################################################

    except:
        exceptions = sys.exc_info()[0]
        print("@@@@@@@@@@@@@@@@@@@ Failure for ResetWinPCAPdriver @@@@@@@@@@@@@@@@@@@, Exceptions: %s" % exceptions)
        #return 0
        traceback.print_exc()
        time.sleep(5.0)

##########################################################################################################
##########################################################################################################
##########################################################################################################

##########################################################################################################
##########################################################################################################
if __name__ == '__main__':
    ResetWinPCAPdriver()
##########################################################################################################
##########################################################################################################