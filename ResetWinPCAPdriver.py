# -*- coding: utf-8 -*-

'''
Reuben Brewer, Ph.D.
reuben.brewer@gmail.com
www.reubotics.com

Apache 2 License
Software Revision L, 06/16/2025

Verified working on: Python 3.11/3.12 for Windows 10/11 64-bit and Raspberry Pi Bookworm.
'''

__author__ = 'reuben.brewer'

#########################################################
import os
import sys
import subprocess
import time
import traceback
import platform

from elevate import elevate #https://pypi.org/project/elevate/
#########################################################

##########################################################################################################
##########################################################################################################
##########################################################################################################
def ResetWinPCAPdriver():

    try:

        ##########################################################################################################
        ##########################################################################################################
        if platform.system() == "Windows":

            elevate(show_console=True)

            print("@@@@@@@@@@@@@@@@@@@ Trying to ResetWinPCAPdriver @@@@@@@@@@@@@@@@@@@")

            subprocess.run("sc stop npf", shell=True)
            subprocess.run("sc start npf", shell=True)

            print("@@@@@@@@@@@@@@@@@@@ Success for ResetWinPCAPdriver @@@@@@@@@@@@@@@@@@@")

            time.sleep(2.0)

            return 1

        else:
            return 0

        ##########################################################################################################
        ##########################################################################################################

    except:
        exceptions = sys.exc_info()[0]
        print("@@@@@@@@@@@@@@@@@@@ Failure for ResetWinPCAPdriver @@@@@@@@@@@@@@@@@@@, Exceptions: %s" % exceptions)
        return 0
        #traceback.print_exc()

##########################################################################################################
##########################################################################################################
##########################################################################################################

##########################################################################################################
##########################################################################################################
if __name__ == '__main__':
    ResetWinPCAPdriver()
##########################################################################################################
##########################################################################################################