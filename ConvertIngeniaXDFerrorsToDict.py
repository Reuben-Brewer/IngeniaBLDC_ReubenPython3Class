# -*- coding: utf-8 -*-

'''
Reuben Brewer, Ph.D.
reuben.brewer@gmail.com
www.reubotics.com

Apache 2 License
Software Revision I, 03/28/2025

Verified working on: Python 3.12 for Windows 10, 11 64-bit.
'''

import os
import xmltodict

##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################
if __name__ == '__main__':

    XML_Filepath = os.getcwd() + "\\InstallFiles_and_SupportDocuments\\cap-xcr-e_eoe_2.6.1.xdf"

    ##########################################################################################################
    ##########################################################################################################
    ##########################################################################################################
    with open(XML_Filepath, 'r') as XML_FileObject:
        XML_Data = XML_FileObject.read()
        XML_DataDict = xmltodict.parse(XML_Data)

        ErrorsData = XML_DataDict["IngeniaDictionary"]["Body"]["Errors"]["Error"]

        StringToPrint = "self.ErrorCodes_DictHexNumberAsKey = dict(["
        KeyCounter = 0

        ##########################################################################################################
        ##########################################################################################################
        for ErrorDict in ErrorsData:
            #print("ErrorDict: " + str(ErrorDict))

            ID = ErrorDict["@id"]
            AffectedModule = ErrorDict["@affected_module"]
            EnglishDesription = ErrorDict["Labels"]["Label"]["#text"]

            StringToPrint = StringToPrint  + "(" + str(ID) + ", \"" + str(EnglishDesription) + "\")"

            ##########################################################################################################
            if KeyCounter < len(ErrorsData) - 1:
                StringToPrint = StringToPrint + ",\n"
            ##########################################################################################################

            KeyCounter = KeyCounter + 1
        ##########################################################################################################
        ##########################################################################################################

        StringToPrint = StringToPrint + "])"

        print(StringToPrint)
    ##########################################################################################################
    ##########################################################################################################
    ##########################################################################################################

##########################################################################################################
##########################################################################################################
##########################################################################################################
##########################################################################################################